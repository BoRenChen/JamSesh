window.Keytrap=function(){"use strict";function e(e){var t=e.keyCode||e.which,n=[t];return e.shiftKey&&16!==e.keyCode&&n.push(16),e.ctrlKey&&17!==e.keyCode&&n.push(17),e.altKey&&18!==e.keyCode&&n.push(18),e.metaKey&&91!==e.keyCode&&n.push(91),n.sort(),n.join("+")}function t(e){return s[e]?s[e]:e.toUpperCase().charCodeAt(0)}function n(e){for(var n=e.split("+"),o=[],i=0;i<n.length;i++)o.push(t(n[i]));return o.sort(),o.join("+")}function o(e){for(var t=[],o=e.split(","),i=0;i<o.length;i++)t.push(n(o[i]));return t}function i(e,t){if(a[t]){for(var n=a[t],o=0;o<n.length;o++)n[o](e);if(c[t]&&e)return jQuery.Event(e).stopPropagation(),!1}}function l(t){return i(t,e(t))}var a={},c={},s={backspace:8,tab:9,enter:13,"return":13,shift:16,ctrl:17,comctrl:17,alt:18,"":18,capslock:20,esc:27,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:46,meta:91,command:91,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,'"':222};return navigator.appVersion.indexOf("Mac")!==-1&&(s.comctrl=91),$(document).on("keydown",l),{bind:function(e,t,n){for(var i=o(e),l=i.length-1;l>=0;l--)jQuery.isArray(a[i[l]])||(a[i[l]]=[]),a[i[l]].push(t),c[i[l]]=!!n},getKeyCode:function(e){return t(e)},getKeyEventID:function(t){return"string"==typeof t?n(t):e(t)},keyEventMatchesKeyCombo:function(t,o){return e(t)===n(o)},trigger:function(e,t){i(e,t)}}}(),function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function o(){!e&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;e=!0;var l=new this;e=!1;for(var a in n)l[a]="function"==typeof n[a]&&"function"==typeof i[a]&&t.test(n[a])?function(e,t){return function(){var n=this._super;this._super=i[e];var o=t.apply(this,arguments);return this._super=n,o}}(a,n[a]):n[a];return o.prototype=l,o.prototype.constructor=o,o.extend=arguments.callee,o}}();var Love={_saveLoveToDBFunc:null,THROTTLE_DELAY:500,init:function(){_.extend(this,AJAXUtil),this.user=window.__user,this._bindToDOM(),this._createSaveLoveToDBFunc()},_createSaveLoveToDBFunc:function(){this._saveLoveToDBFunc=_.throttle(this._saveLoveChange,this.THROTTLE_DELAY,{leading:!1,trailing:!0})},_bindToDOM:function(){$("body").on("click","a.loves, button.loves, span.loves",$.proxy(this._onHeartClick,this))},_onHeartClick:function(e){if(e.preventDefault(),this._userNeedsToLogin())return this._redirectToLogin();var t=$(e.target).closest(".loves");this._isOwned(t)||this._heartItem(t)},_userNeedsToLogin:function(){return 1==this.user.id},_redirectToLogin:function(){window.location="/login?type=love"},_isOwned:function(e){return e.data("owned")},_heartItem:function(e){var t=this._getNextLevel(e);this._showAsHearted(e,t),this._saveLoveToDBFunc(e.data("item"),e.data("hashid"),t)},_getNextLevel:function(e){if(e.hasClass("comment-heart"))return this._isCommentedLoved(e)?0:1;var t=this._findTextLoveLevel(e.attr("class"));return this._nextLoveLevel(t)},_isCommentedLoved:function(e){return e.hasClass("love")},_findTextLoveLevel:function(e){var t=e.match(/loved-(\d)/);return t?1*t[1]:0},_nextLoveLevel:function(e){return 3===e?0:e+1},_showAsHearted:function(e,t){this._isHeartingComment(e)?this._showCommentHeartAsHearted(e,t):this._showStandardHeartAsHearted(e,t)},_isHeartingComment:function(e){return e.hasClass("comment-heart")},_showCommentHeartAsHearted:function(e,t){t>0?e.addClass("love loved-1"):e.removeClass("love loved-1"),this._updateLoveCount(e,t)},_showStandardHeartAsHearted:function(e,t){var n=e.data("hashid"),o=$("[data-hashid='"+n+"']");$.each(o,function(e,n){var o=$(n);if(!o.hasClass("count")){var i=o.hasClass("single-stat")?o:$(".heart-button");i.removeClass("loved-1 loved-2 loved-3 loved-0").attr("aria-pressed",!1).addClass("loved-"+t),0!=t&&i.attr("aria-pressed",!0),Love._updateLoveCount(i,t)}})},_updateLoveCount:function(e,t){var n=e.find("span.count"),o=this._getValueToAddToCount(t);n.html(this._getLoveCount(n,o))},_getValueToAddToCount:function(e){return 0===e?-1:1===e?1:0},_getLoveCount:function(e,t){var n=e.html();if(n){var o=1*n.replace(/[,\. ]/g,""),i=isNaN(o)?0:o;return i+=t,i>0?this._delimit(i):""}return""},_delimit:function(e,t){return t=t||",",e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)},_saveLoveChange:function(e,t,n){var o="/love/"+[e,t,n].join("/");this.post(o,{},function(){this._doneSaveLoveChange(e)})},_doneSaveLoveChange:function(e){"undefined"!=typeof Hub&&Hub.pub(e+"-hearted")}};Love.init(),$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},function(){function e(){$("#team-invite-bar").remove(),location.reload()}function t(t,n){AJAXUtil.put("/teams/invite/1",{accept_invite:t,team_id:n},e)}function n(e,n,o){e.preventDefault(),t(n,o)}$("#team-invite-accept").on("click",function(e){n(e,"true",$(this).data("team-id"))}),$("#team-invite-decline").on("click",function(e){n(e,"false",$(this).data("team-id"))})}(),function(){function e(){$("body").on("change",".collection-choice",t)}function t(e){var t=o(e);[s,r].indexOf(t)===-1&&c(t,i(e))}function n(e){$.showMessage(a(e),"slow"),$(".collections-mini-modal").remove(),u.val(r)}function o(e){return $(e.target).find("option:selected").val()}function i(e){return"pen"===d?CP.pen.slug_hash:$(e.target).closest(".single-pen").data("slug-hash")}function l(e,t){return"/collections/add/"+e+"/"+t}function a(e){var t=e.collection.slug_hash;return e.collection["private"]&&(t=e.collection.slug_hash_private),_.template(Copy.penAddToCollection,{name:e.collection.name,url:"/collection/"+t})}function c(e,t){AJAXUtil.post(l(e,t),{},n)}CP.collectionAddPen={};var s="__add__",r="__choose__",d=window.__pageType,u=$("#collection-choice");CP.collectionAddPen.init=function(){e()}}(),"undefined"==typeof window.Copy&&(window.Copy={}),_.extend(window.Copy,{penRemovedFromCollection:"Pen removed from Collection.",collectionSavedPenAdded:"Your Collection '<%= name %>' was created and this Pen was added to it. <a href='<%= url %>'>View collection</a>.",collectionCreated:"Your Collection '<%= name %>' was created. <a href='<%= url %>'>View collection</a>.",collectionUpdated:"Your Collection '<%= name %>' has been updated.",penAddToCollection:"This Pen was added to the '<%= name %>' collection. <a href='<%= url %>'>View collection</a>.",collectionDeleted:"Your Collection was deleted!"});var CollectionRemovePen=Class.extend({init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){$("body").on("click",".remove-pen-from-collection",$.proxy(this._removePenFromCollection,this))},_removePenFromCollection:function(e){this.post(this._getRemovePenFromCollectionURL($(e.target)),{},$.proxy(this._onDoneRemovePenFromCollection,this))},_getRemovePenFromCollectionURL:function(e){return"/collections/remove/"+window.__collection.slug_hash+"/"+e.data("slug-hash")},_onDoneRemovePenFromCollection:function(){Page.renderPages(window.__pages)}}),CollectionsFlyout=Class.extend({init:function(){this._bindToDOM(),this._bindToHub()},_bindToDOM:function(){$("body").on("click",".add-to-collection-from-flyout",$.proxy(this._show,this)).on("click",".close-button-collections-mini-modal",$.proxy(this._close,this))},_bindToHub:function(){Hub.sub("collection-saved",this._close)},_show:function(e){e.preventDefault(),$.get("/ajax/collections/flyout_mini_modal",function(t){$(e.target).closest(".single-pen").append(t.html)})},_close:function(){$(".collections-mini-modal").remove()}});!function(){function e(e,t){AJAXUtil.put("/collections/"+e.slug_hash,e,t)}function t(e,t){AJAXUtil.post("/collections",e,t)}function n(e){return _.extend(e,{slug_hash:CP.collection.selectedPenSlugHash})}function o(){c({"private":u()})}function i(){e(CP.collection.VM,function(){d()})}function l(){return{id:"",name:"",description:"",slug_hash:"",slug_hash_private:"","private":!1}}function a(){CP.collection.VM=l(),CP.collection._VM=[];for(var e in CP.collection.VM)CP.collection._VM.push(e)}function c(e){for(var t in e)CP.collection._VM.indexOf(t)!==-1&&(CP.collection.VM[t]=e[t])}function s(){c(h)}function r(){var e=CP.collection.VM;return e["private"]?e.slug_hash_private:e.slug_hash}function d(){if(window.history.replaceState&&r()){var e=URLBuilder.getViewURLSimple("collection","",r(),!1);window.history.replaceState(e,"",e)}}function u(){return!!$("#collection-details-private").is(":checked")}var h=window.__collection;CP.collection={},CP.collection.init=function(){a(),s()},CP.collection.updateViewModel=function(e){c(e)},CP.collection.getActiveSlugHash=r,CP.collection.onPrivacyChange=o,CP.collection.onEditPrivacyChange=i,CP.collection.loadBlankViewModel=a,CP.collection.loadInitialViewModel=s,CP.collection.selectedPenSlugHash="",CP.collection.save=function(o){CP.collection.VM.slug_hash.length>0?e(CP.collection.VM,o):t(n(CP.collection.VM),o)}}(),function(){function e(e,t){CP.TextFormatter.put("/text_formatter/text",{text:e},t)}CP.TextFormatter={},CP.TextFormatter.init=function(){_.extend(CP.TextFormatter,AJAXUtil),CP.TextFormatter.formatText=e}}(),function(){function e(){U.on("click",".edit-collection",o).on("click","#add-new-collection-button",n).on("change",".collection-choice",t).on("submit",".collection-settings-form",c).on("click","#add-new-collection-form .ios-toggle",l).on("click","#edit-collection-form .ios-toggle",a),H.on("click",g)}function t(e){m(e)===R&&(k=!0,i(C(e)))}function n(e){e.preventDefault(),i("")}function o(e){L=!0,O=!0,e.preventDefault(),D($(e.target).data("slug-hash"),"")}function i(e){L=!1,O=!1,CP.collection.loadBlankViewModel(),D(0,e)}function l(){CP.collection.onPrivacyChange()}function a(){l(),CP.collection.onEditPrivacyChange(),M()}function c(e){e.preventDefault(),d()}function s(e){e.success?(p(e),v()):AJAXUtil.showStandardErrorMessage(e)}function r(e,t){CP.collection.updateViewModel(t),y(e,t),T(t),Hub.pub("collection-saved")}function d(){P(),CP.collection.save(function(e){r(CP.collection.VM.id,e.collection)})}function u(){Hub.sub("key",h),Hub.sub("popup-open",f)}function h(e,t){"esc"===t.key&&g()}function f(e,t){t!==J&&g()}function p(e){x=$("<div />",{"class":"modal modal-neutral group ",html:e.html}),x.appendTo(U)}function v(){CP.showPopupOverlay(),x.find("#name").focus(),X=!0,x.find(".close-button").on("click",g),Hub.pub("popup-open",J),CP.HelpFlyouts.init()}function g(e){e&&e.preventDefault(),X&&(CP.hidePopupOverlay(),x.remove(),X=!1)}function m(e){return $(e.target).find("option:selected").val()}function C(e){return"pen"===I?CP.pen.slug_hash:$(e.target).closest(".single-pen").data("slug-hash")}function P(){var e=$(".collection-settings-form").serializeObject();CP.collection.updateViewModel(e)}function w(e,t){var n=Copy.collectionUpdated;return O||(n=k?Copy.collectionSavedPenAdded:Copy.collectionCreated),_.template(n,{originalId:e,name:t.name,url:"/collection/"+CP.collection.getActiveSlugHash()})}function D(e,t){CP.collection.selectedPenSlugHash=t;var n;n=e?"/collections/"+e+"/edit?slug_hash="+t:"/collections/new",$.ajax({url:n,success:s})}function y(e,t){$.showMessage(w(e,t),"slow")}function T(e){g(),L&&(j.html(e.name),CP.TextFormatter.formatText(e.description,function(e){F.html(e.text),A()})),b(e)}function b(e){var t;t=e["private"]===!0?S:E,t.append($("<option></option>").attr("value",e.slug_hash).text(e.name)),V.val("__choose__")}function M(){var e=F.find(".private-icon");e.length?e.toggle():A()}function A(){CP.collection.VM["private"]&&F.prepend("<span class='private-icon left'><svg class='icon-lock'><use xlink:href='#lock'></use></svg></span>")}CP.createEditCollection={};var x,L,k,O,U=$("body"),H=$("#popup-overlay"),S=$(".collection-options-public"),E=$(".collection-options-private"),j=$("#collection-name"),F=$("#collection-desc"),V=$(".collection-choice"),R="__add__",J="createEditCollection",X=!1,I=window.__pageType;CP.createEditCollection.init=function(){CP.collection.init(),CP.TextFormatter.init(),e(),u()}}();var DeleteCollection=Class.extend({init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){$("body").on("click",".delete-collection",$.proxy(this._onDeleteCollection,this)).on("click",".delete-collection-from-grid",$.proxy(this._onDeleteCollection,this)).on("click","#confirm-delete[data-item='collection']",$.proxy(this._deleteConfirmed,this))},_onDeleteCollection:function(e){e.preventDefault(),$.showModal("/ajax/collections/confirm_collection_delete"+this._getParams(e),"modal-warning")},_getParams:function(e){return"?collection_slug_hash="+$(e.target).data("slug-hash")+"&pagetype="+$(e.target).data("pagetype")},_deleteConfirmed:function(e){e.preventDefault(),this.del(this._getDeleteURL(e),{},this._getOnDoneFunc(e))},_getDeleteURL:function(e){return"/collections/"+$(e.target).data("slug-hash")},_getOnDoneFunc:function(e){return"grid"===$(e.target).data("pagetype")?this._doneDeleteCollectionOnGrid:this._doneDeleteCollection},_doneDeleteCollectionOnGrid:function(e){this._doneDeleteStandard(e),Hub.pub("collection-deleted",e)},_doneDeleteCollection:function(e){this._doneDeleteStandard(e),setTimeout(function(){window.location="/"+window.__profiled.username+"/collections/public/"},400)},_doneDeleteStandard:function(e){$.hideModal(),$.showMessage(this._getDoneDeleteCollectionMessage(e),"slow")},_getDoneDeleteCollectionMessage:function(e){return _.template(Copy.collectionDeleted,{name:e.collection.name})}}),PenDeleteOnOverlay=Class.extend({deletePenData:{},undoDeletePenTimeout:1e4,init:function(){_.extend(this,AJAXUtil),this._bindToDOM(),this._checkLocalStorage()},_checkLocalStorage:function(){CPLocalStorage.getItem("pen_deleted")&&(this.deletePenData=JSON.parse(CPLocalStorage.getItem("pen_deleted")),CPLocalStorage.removeItem("pen_deleted"),this._showRestoreDeletedPenMessage())},_bindToDOM:function(){$("body").on("click",".delete-pen",$.proxy(this._onDeletePen,this)).on("click","#restore-deleted-pen",$.proxy(this._undoDelete,this))},_onDeletePen:function(e){e.preventDefault(),this._deletePen($(e.target).data("id"),$(e.target).data("slug-hash"))},_deletePen:function(e,t){this.deletePenData.penID=e,this.deletePenData.activeSlugHash=t,this._showConfirmDeleteModal()},_showConfirmDeleteModal:function(){$.showModal("/ajax/confirm_pen_delete","modal-warning",$.proxy(this._deletePenModalCallback,this))},_deletePenModalCallback:function(){$("#confirm-delete")._on("click",this._deletePenConfirmed,this)},_deletePenConfirmed:function(){this._sendDeleteToServer(),this._removePenFromGrid(),this._showRestoreDeletedPenMessage()},_sendDeleteToServer:function(){this.del("/pen/"+this.deletePenData.activeSlugHash,{},this.doneDelete,this.failedDelete)},_removePenFromGrid:function(){$("#del-pen-"+this.deletePenData.penID).closest(".single-pen").slideUp("",function(){$(this).remove()})},_showRestoreDeletedPenMessage:function(){$.showMessage(_.template(this._restorePenMessage(),this.deletePenData),"super-slow")},_restorePenMessage:function(){return"Your pen was deleted. <a id='restore-deleted-pen' data-id='<%= penID %>' data-slug-hash='<%= activeSlugHash %>' href='#0'>Undo?</a>"},DONE_DELETE_TIMEOUT:500,doneDelete:function(){$.hideOverlay(),setTimeout(function(){Page.renderPages(window.__pages)},this.DONE_DELETE_TIMEOUT)},failedDelete:function(e){$.hideMessage(),this.showStandardErrorMessage(e)},_undoDelete:function(e){e.preventDefault(),$.showMessage("Recovering pen...",this.undoDeletePenTimeout),this.post(this._getUndoDeleteURL(e),{},this._doneUndoDelete)},_getUndoDeleteURL:function(e){return"/pen/restore/"+$(e.target).attr("data-slug-hash")},_doneUndoDelete:function(){$.hideMessage(),Page.renderPages(window.__pages)}}),ProjectDeleteOnOverlay=Class.extend({deleteProjectData:{},init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){$("body").on("click",".delete-project",$.proxy(this._onDeleteProject,this))},_onDeleteProject:function(e){e.preventDefault(),this._deleteProject($(e.target).data("id"),$(e.target).data("slug-hash"))},_deleteProject:function(e,t){this.deleteProjectData.id=e,this.deleteProjectData.hashid=t,this._showConfirmDeleteModal()},_showConfirmDeleteModal:function(){$.showModal("/ajax/confirm_project_delete","modal-warning",$.proxy(this._deleteProjectModalCallback,this))},_deleteProjectModalCallback:function(){$("#confirm-delete")._on("click",this._deleteProjectConfirmed,this)},_deleteProjectConfirmed:function(){"delete"===$("#confirm-delete-input").val()&&(this._sendDeleteToServer(),this._removeProjectFromGrid())},_sendDeleteToServer:function(){this.del("/projects/project/"+this.deleteProjectData.hashid,{},this.doneDelete,this.failedDelete)},_removeProjectFromGrid:function(){$("#del-project-"+this.deleteProjectData.id).closest(".single-project").slideUp("",function(){$(this).remove()})},DONE_DELETE_TIMEOUT:500,doneDelete:function(e){$.hideMessage(),$.hideOverlay(),e.payload.remaining_projects>0&&$(".new-project-button.upsell").removeClass("upsell").removeAttr("data-url").off("click"),setTimeout(function(){Page.renderPages(window.__pages)},this.DONE_DELETE_TIMEOUT)},failedDelete:function(e){$.hideMessage(),this.showStandardErrorMessage(e)}}),RemoveAsTemplateOverlay=Class.extend({init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){$("body").on("click",".untemplate-pen",$.proxy(this._onUntemplatePen,this))},_onUntemplatePen:function(e){e.preventDefault(),this._untemplatePen($(e.target).data("hashid")),this._removePenFromPage($(e.target).data("hashid")),this._showMessage()},_untemplatePen:function(e){this.del("/templates/"+e,{item_type:"pen"},this._doneUntemplate)},_removePenFromPage:function(e){$("#untemplate-pen-"+e).closest(".single-pen").slideUp("",function(){$(this).remove()})},_showMessage:function(){$.showMessage(this._removedMessage(),"super-slow")},_removedMessage:function(){return"Your Pen was removed from your templates."},_doneUntemplate:function(){$.hideOverlay(),Page.renderPages(window.__pages)}});new CollectionsFlyout,CP.createEditCollection.init(),new DeleteCollection,CP.collectionAddPen.init(),new CollectionRemovePen,new PenDeleteOnOverlay,new ProjectDeleteOnOverlay,new RemoveAsTemplateOverlay,function(){function e(e){AJAXUtil.get(t(e.grid_url),{},m)}function t(e){var t=e.split("?");return t.length>1?t[0]+"?"+t[1]+"&_cachebust="+(new Date).getTime():e+"?_cachebust="+(new Date).getTime()}function n(){k||(o(),k=!0)}function o(){i(),l(),d()}function i(){$("body").on("click","a.pagination-button",h)}function l(){Keytrap.bind("left",function(e){a(e,"prev")}),Keytrap.bind("right",function(e){a(e,"next")})}function a(e,t){var n=r();c(n,t)&&!s(e)&&f(n.grid_id,t)}function c(e,t){if(e){var n=$("#"+e.grid_id).find(".pagination-button[data-direction='"+t+"']");return n.length>0}return!1}function s(e){return _.include(["input","select","textarea"],e.target.tagName.toLowerCase())}function r(){return _.find(M,{page_is_main_grid:!0})}function d(){x.bind("popstate",u)}function u(e){e.originalEvent.state&&AJAXUtil.get(e.originalEvent.state,{},function(e){m(e,!1)})}function h(e){return e.preventDefault(),setTimeout(function(){var t=$(e.target).closest("a.pagination-button");f(t.data("grid-id"),t.data("direction"))},20),!1}function f(e,t){var n=p(e);AJAXUtil.get(n[t+"_grid_url"],{},m)}function p(e){return _.find(M,{grid_id:e})}function v(e){var t=g(e.grid_id);M[t]=e}function g(e){return _.findIndex(M,{grid_id:e})}function m(e,t){v(e.page),P(e.page),D(e.page,t),b(e),NastyBrowserSniffing.ios&&C()}function C(){$("a.loves, button.loves, span.loves").on("click",function(){})}function P(e){var t=$("#"+e.grid_id);t.html(e.html),w(e,t)}function w(e,t){if(!e.page_is_main_grid||CP.Page.firstTimeLoading)return void(CP.Page.firstTimeLoading=!1);var n=t.parent().offset().top;x.scrollTop()>n&&L.animate({scrollTop:n},A)}function D(e,t){if(e.page_is_main_grid&&T(e,t)){var n=e.page_url,o=window.location.hash;y(e.page_url)?(window.history.replaceState(e.grid_url,"",n),setTimeout(function(){window.location.hash=o},50)):(O?(window.history.replaceState(e.grid_url,"",n),setTimeout(function(){window.location.hash=o},50)):(window.history.pushState(e.grid_url,"",n),setTimeout(function(){window.location.hash=o},50)),O=!1)}}function y(e){var t=e.replace(window.location.pathname,"");return"/"===t}function T(e,t){return t="undefined"==typeof t||t,window.history.pushState&&t}function b(e){Hub.pub("grid-changed",e)}CP.Page={firstTimeLoading:!0},window.Page=CP.Page;var M=[],A=300,x=$(window),L=$("html, body");CP.Page.renderPages=function(t){n(),M=t,M.forEach(e)};var k=!1,O=!0}();var FillHeader={_templatesLoaded:!1,init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){var e=$("#templates-dropdown");e._on("click",this._onTemplateDropdownClick,this,!0),e._on("mouseover",this._onTemplateDropdownClick,this)},_onTemplateDropdownClick:function(){this._templatesLoaded||(this._templatesLoaded=!0,this.get("/templates",{},this._doneTemplateDropdownClick))},_doneTemplateDropdownClick:function(e){$("#pen-templates-dropdown").html(e.html)}},FillActivity={_htmlLoaded:!1,init:function(){_.extend(this,AJAXUtil),this._bindToDOM()},_bindToDOM:function(){var e=$("#header-activity-div");e._on("click",this._onActivityActive,this,!0),e._on("mouseover",this._onActivityActive,this)},_onActivityActive:function(){this._htmlLoaded||(this._htmlLoaded=!0,this.get("/activity/header/",{},this._doneActivityActive))},_doneActivityActive:function(e){$("#activity-dropdown").html(e.html)}};FillHeader.init(),FillActivity.init();var Home={alertsCloseButton:$("#close-alerts-btn"),init:function(){_.extend(this,AJAXUtil),this._bindToDOM(),this._bindToHub(),Page.renderPages(window.__pages)},_bindToDOM:function(){this.alertsCloseButton._on("click",this.closeAlerts,this,!1)},_bindToHub:function(){__mobile&&Hub.sub("grid-changed",function(){window.scrollTo(0,0)})},closeAlerts:function(){$(".news-alerts").slideUp(200),this.post("/alerts/close",{})}};Home.init();